# 알고리즘: 위상 정렬

> 📖 **전체 알고리즘 설명**: [위상 정렬(Topological Sort) 정리](../topological-sort.md)

이 문제는 **위상 정렬(Topological Sort)** 알고리즘을 사용하여 해결합니다.  
상위 폴더의 [위상 정렬 정리 문서](../topological-sort.md)에서 알고리즘의 전체 이론과 개념을 확인할 수 있습니다.

---

## 이 문제에서의 위상 정렬 적용

### 문제 특성

* **부분 순서(Partial Order)**: 일부 학생 쌍에 대한 비교 결과만 주어짐
* **전체 순서(Total Order)**: 모든 비교 조건을 만족하는 줄 세우기 결과 필요
* **입력 크기**: N ≤ 32,000, M ≤ 100,000 (대규모 입력)

---

## 이 문제의 특이사항

### 1️⃣ Kahn 알고리즘 선택 근거

이 문제에서는 **Kahn 알고리즘(진입 차수 기반)**을 선택했습니다.

**선택 이유:**

* ✅ **문제 직관과의 일치**: "앞에서부터 줄 세우기"라는 문제의 도메인 의미와 Kahn 알고리즘의 접근 방식이 자연스럽게 맞음
* ✅ **구현의 단순성**: Queue를 사용한 BFS 스타일이 더 직관적이고 이해하기 쉬움
* ✅ **도메인 모델링의 자연스러움**: "지금 바로 줄에 세울 수 있는 학생"을 Queue에서 선택하는 방식이 문제 상황을 더 잘 표현함

**DFS 기반 알고리즘을 사용하지 않은 이유:**

* 문제 직관과의 거리감: DFS는 "가장 뒤에 올 정점부터 확정"하는 방식
* 구현 복잡도: 재귀 호출로 인한 스택 깊이 문제 가능성

### 2️⃣ 그래프 모델링

* **학생 → 정점(Vertex)**
* **`A가 B보다 앞` → 방향 간선 `A → B`**

이를 통해 부분 순서를 방향 그래프로 표현하고, 위상 정렬을 통해 전체 순서를 구합니다.

### 3️⃣ 시간 복잡도

* **그래프 구성**: O(N + M)
* **위상 정렬 수행**: O(N + M)
* **전체 시간 복잡도**: **O(N + M)**

대규모 입력(N ≤ 32,000, M ≤ 100,000)에서도 안정적으로 동작합니다.

### 4️⃣ 공간 복잡도

* **그래프 저장**: O(N + M) (인접 리스트)
* **진입 차수 배열**: O(N)
* **Queue**: O(N)
* **결과 저장**: O(N)
* **전체 공간 복잡도**: **O(N + M)**

### 5️⃣ 사이클 검출

이 문제에서는 입력이 항상 유효한 DAG라고 가정하므로, 사이클 검출 로직을 구현하지 않아도 됩니다.

> **참고**: 실제 구현에서는 사이클 검출이 필요할 수 있지만, 본 문제에서는 사이클이 존재하지 않습니다.

---

## 핵심 구현 패턴

이 문제에 특화된 Kahn 알고리즘 구현:

```java
Queue<Integer> queue = new ArrayDeque<>();

// 1. 선행 조건이 없는 정점부터 시작
for (int i = 1; i <= N; i++) {
    if (indegree[i] == 0) {
        queue.offer(i);
    }
}

// 2. 정점 배치 → 제약 해제 반복
while (!queue.isEmpty()) {
    int current = queue.poll();
    result.append(current).append(' ');

    for (int next : graph[current]) {
        indegree[next]--;              // 제약 하나 제거
        if (indegree[next] == 0) {     // 모든 제약 해제
            queue.offer(next);
        }
    }
}
```

---

## 다른 위상 정렬 문제와의 차이점

| 특징 | 일반 위상 정렬 | 이 문제 (2252) |
|------|--------------|---------------|
| 알고리즘 선택 | Kahn 또는 DFS | Kahn 알고리즘 권장 |
| 사이클 검출 | 필요할 수 있음 | 불필요 (입력이 항상 DAG) |
| 출력 조건 | 단일 정답 또는 모든 정답 | 임의의 올바른 순서 허용 |
| 입력 크기 | 다양 | 대규모 (N ≤ 32,000) |

---

## 참고

* 전체 위상 정렬 알고리즘 설명: [../topological-sort.md](../topological-sort.md)
* 문제 분석: [1.analysis.md](./1.analysis.md)
* 알고리즘 적용 근거: [3.reasoning.md](./3.reasoning.md)
